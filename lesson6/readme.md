### Задание 1. 

Вы подняли на своём домашнем компьютере с IP-адресом `192.168.0.2` web-сервер.

* Получится ли у пользователей интернета открыть этот сайт?
* Нужно ли будет вам для этого что-то сделать дополнительно?
* Существует ли такой набор настроек провайдера, который не позволит подключение?
 
Поразмышляйте над примером.

*Приведите ответ в свободной форме.*

### Ответ:

Просто так у пользовтелей Интернет не получится открыть этот сайт, так как адрес `192.168.0.2` является приватным.
Для того, чтобы можно было обращаться к этому web-серверу, его нужно опубликовать в сети и настроить StaticNAT.
Провайдер может у себя настроить Firewall и заблокировать публичный адрес этого сайта.

---

### Задание 2. 

- Узел `src` инициировал соединение с узлом `dst`.
- На маршрутизаторе узла `src` была создана трансляция:


| src local IP:port | src global IP:port | dst IP | protocol
| -------- | -------- | -------- | -------- |
| 10.0.0.2:1111     | 93.15.10.2:2222     | 1.1.1.1:80     |tcp|

Применив знания по установке TCP сессий, ответьте на вопросы:
* Сможет ли злоумышленник доставить пакет до `10.0.0.2`, отправив пакет на адрес/порт `93.15.10.2:2222` с адреса `74.5.12.4`?
* А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - `1.1.1.1:80`

*Приведите ответ в свободной форме.*

### Ответ:

Не сможет, так как роутер не будет знать куда направить пакет. Если подменить IP в заголовке, то отправить пакет получится.

---

### Задание 3. 

- Узел `src` инициировал соединение с узлом `dst`.
- На маршрутизаторе узла `src` была создана трансляция:


| src local IP:port | src global IP:port | dst IP | protocol
| -------- | -------- | -------- | -------- |
| 10.0.0.2:1111     | 93.15.10.2:2222     | 8.8.8.8:53     |udp|

Применив знания по работе UDP, ответьте на вопросы:
* Сможет ли злоумышленник доставить пакет до `10.0.0.2`, отправив пакет на адрес/порт `93.15.10.2:2222` с адреса `74.5.12.4`?
* А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - `8.8.8.8:53`

*Приведите ответ в свободной форме.*

### Ответ:

В данном случае у злоумышленника все получится, так как в пакете UPD не прописывается IP отправителя.

---

### Задание 4. 

Найдите самую часто встречающуюся проблему при работе клиентов за NAT с протоколом FTP, связанную с особенностью работы FTP (на лекции по портам эта особенность упоминалась).

1. В чём выражается проблема?
2. Почему она возникает?
3. Что можно сделать, чтобы избежать этой проблемы?

*Приведите ответ в свободной форме.*

### Ответ:

У FTP есть два режима - активный и пассивный. При активном режиме сервер устанавливает соединение к клиенту, в пассивном наоборот. А активном режиме клиент передает на сервер на порт 21 специальную команду PORT и указывает свой адрес и порт для передачи данных. Сервер устанавливает соединение с 20 порта на указанный в команде порт клиента.
Проблема возникает в том, что при работе с NAT адрес будет указан внутренний. Клиент не сможет подключиться к серверу.
Современные реализации NAT умеют отслеживать управляющий канал FTP-соединения и заменяют внутренний адрес внешним. И большинство FTP-серверов имеют опцию, позволяющую указать внешний адрес. Поэтому будет достаточно пробросить 21 порт для управляющей сессии и 20 для активного режима, а также указать и пробросить диапазон динамических портов для передачи данных.

---

### Задание 5. 

Вспомните схему из 3-го урока.

![](https://i.imgur.com/fOE0vdh.png)

Немного перефразируем прошлый вопрос.

 - Поразмышляете, можно ли каким-то образом отправлять пакеты с компьютера `192.168.1.2` на компьютер `192.168.1.3` если они подключены согласно приведённой ниже схеме?
 - Если да, то что и как бы вы предложили настроить? Как и к чему нужно подключаться?

*Приведите ответ в свободной форме.*

### Ответ:

На роутере `10.1.1.2/30` нужно настроить NAT следующим образом:

![Task5](/lesson6/task5.jpg "Задание 5")